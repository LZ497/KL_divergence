\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage{xcolor}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage[a4paper, total={6in, 8in}]{geometry}
\usepackage[utf8]{inputenc}
\usepackage{adjustbox}
\usepackage{makecell}


\title{Variational Bayes with TensorFlow}
\author{Massive Data Institute}
\date{\today}

\begin{document}

\maketitle


\textbf{Unbounded:}

Is it implemented in Tensorflow?

\begin{center}
\begin{tabular}{ c | c c c }
 & Normal & Cauchy & Laplace \\
 \hline
 Normal & Y & N & N \\ 
 Cauchy & N & Y & N \\  
 Laplace & N & N & Y    
\end{tabular}
\end{center}

Is the Derivation on Google?

\begin{center}
\begin{tabular}{ c | c c c }
 & Normal & Cauchy & Laplace \\
 \hline
 Normal & Y & Y & N \\ 
 Cauchy & Y & Y & N \\  
 Laplace & N & N & Y    
\end{tabular}
\end{center}

\begin{center}
\begin{tabular}{ c | c c c }
 & Normal & Cauchy & Laplace \\
 \hline
 Normal & $\frac{\left(\mu_{q}-\mu_{p}\right)^{2}+\sigma_{q}^{2}}{2 \sigma^2_{p}}-\log \sigma_{q}+\log \sigma_{p}-\frac{1}{2}$  & 
 $-\frac{\log \left(2 \pi \sigma_{q}^{2}\right)+1}{2} +\log{\pi s}+\frac{1}{\sigma\sqrt{2\pi}} \int_{-\infty}^{+\infty} e^{-\frac{1}{2}(\frac{x-\mu}{\sigma})^{2}}log(1+\frac{(x-l)^{2}}{s^{2}} )dx$ & 
$ -\frac{\log \left(2 \pi \sigma_{q}^{2}\right)+1}{2}+log2b + 2\int_{\mu_{p}}^{+\infty} \frac{1}{\sigma\sqrt{2\pi}} e^{-\frac{1}{2}(\frac{x-\mu_{q}}{\sigma})^{2}}\log{\frac{x-\mu_{p}}{b}} $ \\ 
 Cauchy & $-\log (4 \pi s_{p})+ 
 log\sigma\sqrt{2\pi}\frac{1}{\pi}arctan\frac{x-l}{s_{p}}  -\frac{1}{2}\int 
 \frac{s_{p}}{\pi}\frac{1}{(x-l)^{2}+s_{p}^{2}}(\frac{x-\mu}{\sigma} )^{2} dx $ & 
 $\log\frac{\left(s_{p}+s_{q}\right)^{2}+\left(l_{p}-l_{q}\right)^{2}}{4 s_{p} s_{q}}$ & 
$-\log (4 \pi s_{p})+\frac{1}{\pi}log2b\arctan\frac{x-l}{s}  +\int \frac{s}{\pi b} \frac{\left | x-\mu \right | }{(x-l)^{2}+s^{2}}$ \\  
 Laplace & $-1-\log \left(2 b_{p}\right)+ \frac{b^{2}}{\sigma^{2}}+log(\sqrt{2\pi}\sigma) $
 & 
 $-\log (4 \pi s_{p})+log\pi+ \int log(\frac{s}{(x-l)^{2}+s^{2}} )\frac{e^{-\frac{\left | x-\mu \right | }{b} } }{2b} dx $ 
 & 
 $\frac{b_{p} \exp \left(-\frac{\left|\mu_{p}-\mu_{q}\right|}{b_{p}}\right)+\left|\mu_{p}-\mu_{q}\right|}{b_{q}}+\log \frac{b_{q}}{b_{p}}-1 $
\end{tabular}
\end{center}

Links:
\begin{itemize}
    \item Normal-Cauchy: https://math.stackexchange.com/questions/1098852/kullback-leibler-divergence-between-standard-gaussian-distribution-and-standard
\end{itemize}


\textbf{Half Bounded:}

Is it implemented in Tensorflow?

\begin{center}
\begin{tabular}{ c | c c c }
 & HalfNormal & Gamma & Lognormal \\
 \hline
 HalfNormal & Y & N & N \\ 
 Gamma & N & Y & N \\  
 Lognormal & N & N & Y    
\end{tabular}
\end{center}

Is the Derivation on Google?

\begin{center}
\begin{tabular}{ c | c c c }
 & HalfNormal & Gamma & LogNormal \\
 \hline
 HalfNormal & Y & N & N \\ 
 Gamma & N & Y & Y \\  
 LogNormal & N & Y & Y   
\end{tabular}
\end{center}

\begin{center}
\begin{adjustbox}{angle=90}
\begin{tabular}{ c | c c c}
 & HalfNormal & Gamma & LogNormal \\
 \hline
 HalfNormal & $- \frac{1}{2} \log\left(2 \pi e \sigma_{p}^{2}\right)+1 -\log(\frac{\sqrt{2}}{\sigma_{q}\sqrt{\pi}} )+\frac{\sigma_{p}^{2}}{2\sigma_{q}^{2}}$
 & 
 $-\frac{1}{2} \log\left(2 \pi e \sigma^{2}\right)+1+\log(\Gamma (k)\theta^{k} )+\frac{\sqrt{2}\sigma}{\theta\sqrt\pi} +\int_{0}^{+\infty} \frac{\sqrt{2}(k-1)}{\theta\sqrt\pi}e^{-\frac{x^{2}}{2\sigma^{2}} }\log x dx $ & 
 $-\frac{1}{2} \log\left(2 \pi e \sigma^{2}\right)+1+\log(\sigma_{q}\sqrt{2\pi}) + \int_{0}^{\infty} \frac{\sqrt{2}}{\sigma_{p}\sqrt{\pi}}e^{-\frac{x^{2}}{2\sigma_{p}^{2}}\frac{(\log{x}-\mu^{2})^{2}}{2\sigma_{q}^{2}}}dx $ &
 Gamma & 
 $-k-\ln (\theta)-\ln (\Gamma(k))-(1-k) \psi(k) + \int_{0}^{+\infty } (\frac{\log\frac{\sqrt{2}}{\sigma{\sqrt{\pi}}} }{\Gamma (k)\theta^{k}} x^{k+1}e^{-\frac{x}{\theta}}+\frac{x^{k+1}}{2\sigma^{2}\Gamma (k)\theta^{k}}e^{-\frac{x}{\theta} })dx $
 & 
 $\left(k_{p}-k_{q}\right) \psi\left(k_{p}\right)-\log \Gamma\left(k_{p}\right)+\log \Gamma\left(k_{q}\right)+k_{q}\left(\log \theta_{q}-\log \theta_{p}\right)+k_{p}\frac{\theta_{p}-\theta_{q}}{\theta_{q}}$ & 
\makecell{\tiny$\mathbf{k}-\log (\theta \Gamma(k))+(-1+k) \text { PolyGamma }(0, k) + $\\$ \tiny\frac{1}{2 \sigma^{2}}\left(\mu^{2}+\sigma^{2} \log (2 \pi)-2 \mu \log (\theta)+\log (\theta)^{2}+2 \sigma^{2} \log (\theta \sigma)+2\left(-\mu+\sigma^{2}+\log (\theta)\right) \text { PolyGamma }(0, k)+\text { PolyGamma }(0, k)^{2}+\text { PolyGamma }(1, k)\right)$} \\  
 LogNormal & $-\frac{1}{2}-\log (\sigma_{p} \sqrt{2 \pi})+-\mu_{p}+\frac{\log(\frac{\sqrt{2}}{\sigma_{p}} )e^{\frac{\sqrt{2}\mu_{p}}{\sigma_{p}} }}{(\sqrt{2}+\sigma_{p})(\sqrt{2\pi})}+\frac{e^{\frac{\sqrt2}{\sigma_{q}}}}{2\sqrt{2\pi}\sigma^{2}_{q}(\sigma_{q}-\sqrt{2})}$
 & $-\frac{1}{2}-\log (\sigma \sqrt{2 \pi})-\mu-\int_{0}^{+\infty } \frac{e^{-\frac{(\log{x}-\mu)^{2}}{2\theta^{2}} }}{x\sigma\sqrt{2\pi}} \log\frac{x^{k-1}}{\Gamma(k)\theta^{k}}dx+\frac{\int_{0}^{+\infty} x^{\frac{2-\sqrt{2\sigma}}{\sqrt2\sigma}e^{x} }dx }{(\sigma-\sqrt{2\pi})e^{\theta+\frac{2\mu}{\sqrt{2\sigma}}}}$
 & 
 $\frac{1}{2 \sigma_{q}^{2}}\left[\left(\mu_{p}-\mu_{q}\right)^{2}+\sigma_{p}^{2}-\sigma_{q}^{2}\right]+\ln \frac{\sigma_{q}}{\sigma_{p}}$
\end{tabular}
\end{adjustbox}
\end{center}



Links:
\begin{itemize}
    \item Gamma-Lognormal: https://stats.stackexchange.com/questions/133886/kl-divergence-between-a-gamma-distribution-and-a-lognormal-distribution
\end{itemize}

\textbf{Bounded:}

Is it implemented in Tensorflow?

\begin{center}
\begin{tabular}{ c | c c c }
 & Beta & LogitNormal & Uniform \\
 \hline
 Beta & Y & N & N \\ 
 LogitNormal & N & Y & N \\  
 Uniform & N & N & Y    
\end{tabular}
\end{center}

Is the Derivation on Google?

\begin{center}
\begin{tabular}{ c | c c c }
 & Beta & logitnormal & Uniform \\
 \hline
 Beta & Y & N & N \\ 
 logitnormal & N & Y & N \\  
 Uniform & N & N & Y    
\end{tabular}
\end{center}



\begin{center}
\begin{tabular}{ c | c c c }
 & Beta & logitnormal & Uniform \\
 \hline
 Beta & 
 $log(\frac{B(\alpha_{q},\alpha_{q})}{B(\alpha_{p},\alpha_{p})})+(\alpha_{p}-\alpha_{q})\psi(\alpha_{p})+(\beta_{p}-\beta_{q})\psi(\beta_{p})+(\alpha_{q}-\alpha_{p}+\beta_{q}-\beta_{p})\psi(\alpha_{p}+\beta_{p})$
 & $-log(B(\alpha_{p},\beta_{p}))-(\alpha_{p}-1)\psi(\alpha_{p})-(\beta_{p}-1)\psi(\beta_{p})+(\alpha_{p}+\beta_{p}-2)\psi(\alpha_{p}+\beta_{p})+\log\sigma\sqrt{2\pi}+\int_{0}^{1} \frac{x^{\alpha-1}(1-x)^{\beta-1}}{B(\alpha ,\beta)} (\frac{(logitx-\mu)^2}{2\sigma^{2}}+\log{x(1-x)} )$
 & $-log(B(\alpha_{p},\beta_{p}))-(\alpha_{p}-1)\psi(\alpha_{p})-(\beta_{p}-1)\psi(\beta_{p})+(\alpha_{p}+\beta_{p}-2)\psi(\alpha_{p}+\beta_{p})+\int_{(0,1)\cap(a,b) } \frac{x^{\alpha-1}(1-x)^{\beta-1}}{B(\alpha-\beta)}\log(b-a) dx$\\
 logitnormal & N & Y & N \\  
 Uniform & $-log(b-a)+\frac{1}{b-a}
\int_{(0,1)\cap(a,b) }\log{\frac{x^{\alpha-1}(1-x)^{\beta-1}}{B(\alpha-\beta)}} dx$
 & $ -log(b-a)+\int_{(0,1)\cap(a,b) }\frac{1}{b-a}\log{\frac{1}{\sigma \sqrt{2 \pi}} e^{-\frac{(\operatorname{logit}(x)-\mu)^{2}}{2 \sigma^{2}}} \frac{1}{x(1-x)}}dx$
 & $\frac{log(b_{q}-a_{q})(\min \{b_{p},b_{q}\}-\min \{a_{p},a_{q}\}+a_{p}-b_{p})}{b_{q}-a_{q}}$
\end{tabular}
\end{center}


\section{Unbounded}

\subsection{Normal Reference}

\noindent \textbf{Entropy:}

$$ \begin{aligned} \text { Entropy }&=-\mathbb{E}_{Q}\left[\log f_{q}\right] \\ &=-\mathbb{E}_{Q}\left[log(\frac{1}{\sigma_{q} \sqrt{2 \pi}} e^{-\frac{(x-\mu_{q})^{2}}{2 \sigma_{q}^{2}}})\right] \\ &=-\mathbb{E}_{Q}\left[-\frac{1}{2} \log \left(2 \pi \sigma_{q}^{2}\right)-\frac{\left(x-\mu_{q}\right)^{2}}{2 \sigma_{q}^{2}}\right] \\ &=\frac{\log \left(2 \pi \sigma_{p}^{2}\right)}{2}+\frac{\mathbb{E}_{Q}\left[(x-\mu_{q})^2 \right]}{2 \sigma^2_{q}}\\ &=\frac{\log \left(2 \pi \sigma_{p}^{2}\right)}{2}+\frac{\mathbb{E}_{Q}\left[x^2 \right]-\mu_{q}^{2}}{2\sigma^2_{p}}\\ &=\frac{\log \left(2 \pi \sigma_{p}^{2}\right)}{2}+\frac{\sigma_{q}^{2}}{2\sigma^2_{p}}\\ &=\frac{\log \left(2 \pi \sigma_{q}^{2}\right)+1}{2} \end{aligned} $$

\subsubsection{Normal Target}

\noindent \textbf{Existing Work:}

\noindent \textbf{Cross-Entropy:}

$$ \begin{aligned} \text { CrossEntropy }&=-\mathbb{E}_{Q}\left[\log f_{p}\right] \\ &=-\mathbb{E}_{Q}\left[log(\frac{1}{\sigma_{p} \sqrt{2 \pi}} e^{-\frac{(x-\mu_{p})^{2}}{2 \sigma_{p}^{2}}})\right] \\ &= -\mathbb{E}_{Q}\left[-\frac{1}{2} \log \left(2 \pi \sigma_{p}^{2}\right)-\frac{\left(x-\mu_{p}\right)^{2}}{2 \sigma_{p}^{2}}\right] \\ &=\frac{\log \left(2 \pi \sigma_{p}^{2}\right)}{2}+\frac{\mathbb{E}_{Q}\left[(x-\mu_{p})^2 \right]}{2 \sigma^2_{p}}\\ &=\frac{\log \left(2 \pi \sigma_{p}^{2}\right)}{2}+\frac{\mathbb{E}_{Q}\left[x^2 \right]+\mu_{q}^{2}-2\mu_{p}\mu_{q} }{2\sigma^2_{p}}\\ &=\frac{\log \left(2 \pi \sigma_{p}^{2}\right)}{2}+\frac{\sigma_{q}^{2}+\mu_{p}^{2}+\mu_{q}^{2}-2\mu_{p}\mu_{q} }{2\sigma^2_{p}}\\ &=\frac{\log \left(2 \pi \sigma_{p}^{2}\right)}{2}+\frac{\left(\mu_{q}-\mu_{p}\right)^{2}+\sigma_{q}^{2}}{2 \sigma^2_{p}} \end{aligned} $$


\noindent \textbf{KL:}

$$ \begin{aligned} \mathrm{KL}\left(\mathrm{N}\left(\mu_{q}, \sigma_{q}^{2}\right) \| \mathrm{N}\left(\mu_{p}, \sigma_{p}^{2}\right)\right)&=-\text { Entropy }+\text { CrossEntropy } \\ &=-\frac{\log \left(2 \pi \sigma_{q}^{2}\right)+1}{2}+ \frac{\log \left(2 \pi \sigma_{p}^{2}\right)}{2}+\frac{\left(\mu_{q}-\mu_{p}\right)^{2}+\sigma_{q}^{2}}{2 \sigma^2_{p}} \\ &=\frac{\left(\mu_{q}-\mu_{p}\right)^{2}+\sigma_{q}^{2}}{2 \sigma^2_{p}} +\frac{\log \left(2 \pi \sigma_{p}^{2}\right)- \log \left(2 \pi \sigma_{q}^{2}\right)-1}{2} \\ &=\frac{\left(\mu_{q}-\mu_{p}\right)^{2}+\sigma_{q}^{2}}{2 \sigma^2_{p}} +\frac{2\log \left(\sigma_{p}-\sigma_{q}\right)-1}{2} \\ &=\frac{\left(\mu_{q}-\mu_{p}\right)^{2}+\sigma_{q}^{2}}{2 \sigma^2_{p}}-\log \sigma_{q}+\log \sigma_{p}-\frac{1}{2} \end{aligned} $$

\subsubsection{Normal-Laplace}

$$ \begin{aligned} \text { CrossEntropy }&=
-\int_{-\infty}^{\infty} q_{ \mu,\sigma}(x) \log p_{b,\mu(x)} \mathrm{d} x \\
&=\log{2b}+\frac{-2\sigma^{2}+2\sigma^2\exp{\frac{-\mu_{p}^{2}}{2\sigma_{2}} }-\mu_{p}^{2}\exp{\frac{-\mu_{q}^{2}}{2\sigma_{2}} }-2(\frac{\sigma^{2}\mu_{p}}{\mu_{q}}-\frac{\sigma^{4}}{\mu_{q}^{2}}\exp{\frac{\mu_{p}\mu_{q}}{\sigma^{2}} })}{b\sigma\sqrt{2\pi}}+\frac{\mu_{p}}{b}+\frac{(1-\frac{\mu_{p}}{b})(1+erf(\frac{\mu_{p}-\mu_{q}}{\sigma\sqrt{2\pi}} )}{2} 
\end{aligned}
$$
$$ \begin{aligned} \mathrm{KL}\left(\mathrm{N}\left(\mu_{q}, \sigma_{q}^{2}\right) \| \mathrm{Laplace}\left(b_{p}, \sigma_{p}\right)\right)&=-\frac{\log \left(2 \pi \sigma_{q}^{2}\right)+1}{2} +\log{2b}+\frac{-2\sigma^{2}+2\sigma^2\exp{\frac{-\mu_{p}^{2}}{2\sigma_{2}} }-\mu_{p}^{2}\exp{\frac{-\mu_{q}^{2}}{2\sigma_{2}} }-2(\frac{\sigma^{2}\mu_{p}}{\mu_{q}}-\frac{\sigma^{4}}{\mu_{q}^{2}}\exp{\frac{\mu_{p}\mu_{q}}{\sigma^{2}} })}{b\sigma\sqrt{2\pi}}+\frac{\mu_{p}}{b}+\frac{(1-\frac{\mu_{p}}{b})(1+erf(\frac{\mu_{p}-\mu_{q}}{\sigma\sqrt{2\pi}} )}{2} 
\end{aligned} $$
\subsubsection{Normal-Cauchy}
$$ \begin{aligned}  \text { CrossEntropy }&=-\int_{-\infty}^{\infty} q_{\mu,\sigma}(x) \log p_{s,l(x)} \mathrm{d} x \\
&=\log{\pi s}+\frac{1}{\sigma\sqrt{2\pi}} \int_{-\infty}^{+\infty} e^{-\frac{1}{2}(\frac{x-\mu}{\sigma})^{2}}log(1+\frac{(x-l)^{2}}{s^{2}} )dx \\
\end{aligned}
$$
$$ \begin{aligned} \mathrm{KL}\left(\mathrm{N}\left(\mu_{q}, \sigma_{q}^{2}\right) \| \mathrm{Cauchy}\left(s, l\right)\right)&=-\frac{\log \left(2 \pi \sigma_{q}^{2}\right)+1}{2} +\log{\pi s}+\frac{1}{\sigma\sqrt{2\pi}} \int_{-\infty}^{+\infty} e^{-\frac{1}{2}(\frac{x-\mu}{\sigma})^{2}}log(1+\frac{(x-l)^{2}}{s^{2}} )dx
\end{aligned}
$$

\subsection{Cauchy Reference}

\noindent \textbf{Entropy:}
$$ \begin{aligned} \text { Entropy } &=-\int_{-\infty}^{\infty} p_{l_{p}, s_{p}}(x) \log p_{l_{p}, s_{p}}(x)\\
&=\log (4 \pi s_{p})\end{aligned} $$

\subsubsection{Cauchy Target}

\noindent \textbf{Existing Work:}

\noindent \textbf{Cross-Entropy:}
$$ \begin{aligned} \text { CrossEntropy }&=-\int_{-\infty}^{\infty} p_{l_{p}, s_{p}}(x) \log q_{l_{q}, s_{q}}(x) \mathrm{d} x\\& =\frac{s}{\pi} \int \frac{1}{s^{2}+x^{2}} \log \left(1+x^{2}\right) \mathrm{d} x+\log \pi+\log s_{q}, \\
&=\log \pi s_{q}+\frac{s}{\pi} I(1, s) \\
&=\log \pi \frac{\left(s_{p}+s_{q}\right)^{2}+\left(l_{p}-l_{q}\right)^{2}}{s_{q}}\\
\end{aligned} $$

\noindent \textbf{KL:}

$$ \begin{aligned}\mathrm{KL}\left(p_{l_{p}, s_{p}}: p_{l_{q}, s_{q}}\right)&=-\text { Entropy }+\text { CrossEntropy } \\&=-\log (4 \pi s_{p})+\log \pi \frac{\left(s_{p}+s_{q}\right)^{2}+\left(l_{p}-l_{q}\right)^{2}}{s_{q}}\\&=\log\frac{\left(s_{p}+s_{q}\right)^{2}+\left(l_{p}-l_{q}\right)^{2}}{4 s_{p} s_{q}}\end{aligned} $$

Links:
\begin{itemize}
    \item https://arxiv.org/pdf/1905.10965.pdf
    \item https://arxiv.org/pdf/1904.10428.pdf
\end{itemize}

\subsubsection{Cauchy-Normal}
$$ \begin{aligned} \text { CrossEntropy }&=
-\int_{-\infty}^{\infty} p_{l_{p}, s_{p}}(x) \log q_{\mu, \sigma(x)} \mathrm{d} x \\
&=log\sigma\sqrt{2\pi}\frac{1}{\pi}\arctan\frac{x-l}{s_{p}}  -\frac{1}{2} \int  \frac{s_{p} }{\pi}\frac{1}{(x-l)^{2}+s_{p}^{2}}(\frac{x-\mu}{\sigma} )^{2} dx
\end{aligned} $$

\subsubsection{Cauchy-Laplace}
$$
\begin{aligned} \text { CrossEntropy }&=
-\int_{-\infty}^{\infty} p_{l_{p}, s_{p}}(x) \log q_{b, \mu(x)} \mathrm{d} x \\
&=\frac{1}{\pi}log2b\arctan\frac{x-l}{s}  +\int \frac{s}{\pi b} \frac{\left | x-\mu \right | }{(x-l)^{2}+s^{2}}dx 
\end{aligned}$$


\subsection{Laplace Reference}

\noindent \textbf{Entropy:}
$$ \begin{aligned} \text { Entropy }&=-\int_{-\infty}^{\infty} p(x) \log p(x) d x\\&=-\int_{-\infty}^{\infty}\frac{1}{2 b_{p}} \exp \left(-\frac{\left|x-\mu_{p}\right|}{b_{p}}\right) \log \frac{1}{2 b_{p}} \exp \left(-\frac{\left|x-\mu_{p}\right|}{b_{p}}\right) d x&\\&=1+\log \left(2 b_{p}\right)
\end{aligned} $$

\subsubsection{Laplace Target}

\noindent \textbf{Existing Work:}

\noindent \textbf{Cross-Entropy:}
$$ \begin{aligned} \text { CrossEntropy }
\quad &=-\int_{-\infty}^{\infty} p(x) \log q(x) d x \\
\quad &=\int_{-\infty}^{\infty} \frac{\left|x-\mu_{q}\right|}{2 b_{p} b_{q}} \exp \left(-\frac{\left|x-\mu_{p}\right|}{b_{p}}\right) d x+\log \left(2 b_{q}\right)\\&=e^{\left(-\frac{\left|\mu_{p}-\mu_{q}\right|}{b_{p}}+\log{\frac{b_{q}}{b_{p}}}\right)} +\frac{ \left|\mu_{p}-\mu_{q}\right|}{b_{q}}+\log \left(2 b_{q}\right)
\end{aligned}
 $$
\noindent \textbf{KL:}

$$ \begin{aligned}\mathrm{KL}\left(\mathrm{Laplace}\left(\mu_{p}, \sigma_{p}^{2}\right) \| \mathrm{Laplace}\left(\mu_{q}, \sigma_{q}^{2}\right)\right)&=-\text { Entropy }+\text{ CrossEntropy }\\&=-1-\log \left(2 b_{p}\right)+\frac{b_{p} \exp \left(-\frac{\left|\mu_{p}-\mu_{q}\right|}{b_{p}}\right)+\left|\mu_{p}-\mu_{q}\right|}{b_{q}}+\log \left(2 b_{q}\right)\\&=e^{\left(-\frac{\left|\mu_{p}-\mu_{q}\right|}{b_{p}}+\log{\frac{b_{q}}{b_{p}}}\right)} +\frac{ \left|\mu_{p}-\mu_{q}\right|}{b_{q}}+\log \frac{b_{q}}{b_{p}}-1\\
\end{aligned}
$$
Links:
\begin{itemize}
    \item  https://openaccess.thecvf.com/content/CVPR2021/supplemental/Meyer\_An\_Alternative\\\_Probabilistic\_CVPR\_2021\_supplemental.pdf
\end{itemize}


\subsubsection{Laplace-Normal}
$$ \begin{aligned} \text { CrossEntropy }&=
-\int_{-\infty}^{\infty} q_{b,\mu}(x) \log p_{\mu, \sigma(x)} \mathrm{d} x \\
&=\frac{(\mu_{q}-\mu_{p})^{2}+2b^{2}}{2\sigma^{2}}+log(\sqrt{2\pi}\sigma) 
\end{aligned}
 $$
 
$$ \begin{aligned} \mathrm{KL}\left(\mathrm{Laplace}\left(\mu_{q}, b\right) \| \mathrm{N}\left(\mu_{p}, \sigma\right)\right)&= -1-\log \left(2 b\right)+\frac{(\mu_{q}-\mu_{p})^{2}+2b^{2}}{2\sigma^{2}}+log(\sqrt{2\pi}\sigma) 
 \end{aligned}
 $$
 
\subsubsection{Laplace-Cauchy}
$$ \begin{aligned} \text { CrossEntropy }&=
-\int_{-\infty}^{\infty} q_{b,\mu}(x) \log p_{s, la(x)} \mathrm{d} x \\
&=log\pi+ \int log(\frac{s}{(x-l)^{2}+s^{2}} )\frac{e^{-\frac{\left | x-\mu \right | }{b} } }{2b} dx \\
\end{aligned}
 $$
 
\section{Half-Bounded}
\subsection{HalfNorm Reference}

\noindent \textbf{Entropy:}
$$ \begin{aligned} \text { Entropy }&=-\int_{0}^{\infty} f(x) \log f(x) d x\\&=-\int_{0}^{\infty}\frac{\sqrt{2}e^{-\frac{x^{2} }{2\sigma^{2}}}}{\sigma\sqrt{\pi}}\log\frac{\sqrt{2}e^{-\frac{x^{2} }{2\sigma^{2}}}}{\sigma\sqrt{\pi}} d x\\&=\frac{1}{2} \log\left(2 \pi e \sigma^{2}\right)-1
\end{aligned} $$

\subsubsection{HalfNorm Target}

\noindent \textbf{Existing Work:}

\noindent \textbf{Cross-Entropy:}
$$ \begin{aligned} \text { CrossEntropy }&=-\int_{0}^{+\infty} p_{\sigma_{p}}(x) \log q_{\sigma_{q}}(x) \mathrm{d} x \\&=
-\log(\frac{\sqrt{2}}{\sigma_{q}\sqrt{\pi}} )+\frac{\sigma_{p}^{2}}{2\sigma_{q}^{2}} \\
\end{aligned} $$
\noindent \textbf{KL:}
$$ \begin{aligned}\mathrm{KL}\left(\mathrm{Halfnorm}\left(\sigma_{p}\right) \| \mathrm{Halfnorm}\left(\sigma_{q}\right)\right)&=-\text { Entropy }+\text{ CrossEntropy }\\&=
- \frac{1}{2} \log\left(2 \pi e \sigma_{p}^{2}\right)+1 -\log(\frac{\sqrt{2}}{\sigma_{q}\sqrt{\pi}} )+\frac{\sigma_{p}^{2}}{2\sigma_{q}^{2}} \\
\end{aligned} $$

\subsubsection{HalfNorm-Gamma}
$$ \begin{aligned} \text { CrossEntropy }&=-\int_{0}^{+\infty} p_{\sigma}(x) \log q_{k, \theta}(x) \mathrm{d} x \\
&=\log(\Gamma (k)\theta^{k} )+\frac{\sqrt{2}\sigma}{\theta\sqrt\pi} +\int_{0}^{+\infty} \frac{\sqrt{2}(k-1)}{\theta\sqrt\pi}e^{-\frac{x^{2}}{2\sigma^{2}} }\log x dx\\
\end{aligned} $$

\subsubsection{HalfNorm-Lognormal}

$$ \begin{aligned} \text { CrossEntropy }&=-\int_{0}^{+\infty} p_{\sigma_{p}}(x) \log q_{\mu_{q}, \sigma_{q}}(x) \mathrm{d} x \\
&=\log(\sigma_{q}\sqrt{2\pi}) + \int_{0}^{\infty} \frac{\sqrt{2}}{\sigma_{p}\sqrt{\pi}}e^{-\frac{x^{2}}{2\sigma_{p}^{2}}\frac{(\log{x}-\mu^{2})^{2}}{2\sigma_{q}^{2}}}dx \\
\end{aligned} $$

\subsection{Gamma Reference}

\noindent \textbf{Entropy:}
$$ \begin{aligned} \text { Entropy }&=k+\ln (\theta)+\ln (\Gamma(k))+(1-k) \psi(k) \end{aligned} $$

\subsubsection{Gamma Target}
\noindent \textbf{Existing Work:}

\noindent \textbf{Cross-Entropy:}
$$ \begin{aligned} \text { CrossEntropy }&=-\int_{0}^{+\infty} p_{k_{p},\theta_{p}}(x) \log q_{k_{q},\theta_{q}}(x) \mathrm{d} x \\
&=\int_{0}^{+\infty} }\frac{x^{k_{p}-1}} {\Gamma(k_{p})\theta^{k_{p}}_{p}}e^{-\frac{x}{\theta_{p}} }\log(\frac{x^{k_{q}-1}} {\Gamma(k_{q})\theta^{k_{q}}_{q}}e^{-\frac{x}{\theta_{q}} })dxdx \\
\end{aligned} $$
\noindent \textbf{KL:}

$$ \begin{aligned} \mathrm{KL}\left(k_{p}, \theta_{p} ; k_{q}, \theta_{q}\right)=&\left(k_{p}-k_{q}\right) \psi\left(k_{p}\right)-\log \Gamma\left(k_{p}\right)+\log \Gamma\left(k_{q}\right) \\
&+k_{q}\left(\log \theta_{q}-\log \theta_{p}\right)+k_{p} \frac{\theta_{p}-\theta_{q}}{\theta_{q}}\end{aligned} $$


Links:
\begin{itemize}
    \item https://statproofbook.github.io/P/gam-kl
\end{itemize}

\subsubsection{Gamma-HalfNorm}

$$ \begin{aligned} \text { CrossEntropy }&=-\int_{0}^{+\infty} p_{k, \theta}(x) \log q_{\sigma}(x) \mathrm{d} x \\
=&\int_{0}^{+\infty } (\frac{\log\frac{\sqrt{2}}{\sigma{\sqrt{\pi}}} }{\Gamma (k)\theta^{k}} x^{k+1}e^{-\frac{x}{\theta}}+\frac{x^{k+1}}{2\sigma^{2}\Gamma (k)\theta^{k}}e^{-\frac{x}{\theta} })dx\\
\end{aligned} $$
\subsubsection{Gamma-Lognormal}
$$ \begin{aligned} \text { CrossEntropy }&=-\int_{0}^{+\infty} p_{k, \theta}(x) \log q_{\sigma,\mu}(x) \mathrm{d} x \\
&=\int_{0}^{+\infty } (\frac{\log x\sigma\sqrt{2\pi} }{\Gamma(k)\theta^{k}} x^{k-1}e^{-\frac{k}{\theta} }+\frac{x^{k-1}(\log x-\mu)}{2\sigma^{2}\Gamma(k)\theta^{k}}e^{-\frac{k}{\theta} })dx\\
\end{aligned} $$

\subsection{Lognormal Reference}

\noindent \textbf{Entropy:}
$$ \begin{aligned} \text { Entropy }&=\frac{1}{2}+\log (\sigma \sqrt{2 \pi})+\mu
\end{aligned} $$

\subsubsection{Lognormal Target}

\noindent \textbf{Existing Work:}

\noindent \textbf{Cross-Entropy:}
$$ \begin{aligned} \text { CrossEntropy }&=-\int_{0}^{+\infty} p_{\sigma_{p},\mu_{p}}(x) \log q_{\sigma_{q},\mu_{q}}(x) \mathrm{d} x\\
&=\frac{1}{x \sigma_{p} \sqrt{2 \pi}} e^{\left(-\frac{(\ln (x)-\mu_{p})^{2}}{2 \sigma_{p}^{2}}\right)}\log(\frac{1}{x \sigma_{q} \sqrt{2 \pi}} e^{\left(-\frac{(\ln (x)-\mu_{q})^{2}}{2 \sigma_{q}^{2}}\right)})dx
\end{aligned} $$
\noindent \textbf{KL:}

$$ \begin{aligned}
\mathrm{KL}\left(\mu_{p}, \sigma_{p} ; \mu_{q}, \sigma_{q}\right)=&\frac{1}{2 \sigma_{q}^{2}}\left[\left(\mu_{p}-\mu_{q}\right)^{2}+\sigma_{p}^{2}-\sigma_{q}^{2}\right]+\ln \frac{\sigma_{q}}{\sigma_{p}}
\end{aligned} $$

Links:
\begin{itemize}
 \item  https://stats.stackexchange.com/questions/411171/how-is-the-formula-for-the-entropy\\-of-the-lognormal-distribution-derived
\end{itemize}

\subsubsection{Lognormal-HalfNorm}

$$ \begin{aligned} \text { CrossEntropy }&=-\int_{0}^{+\infty} p_{\mu_{p},\sigma_{p}}(x) \log q_{\sigma_{q}}(x) \mathrm{d} x \\
&=\frac{\log(\frac{\sqrt{2}}{\sigma_{p}} )e^{\frac{\sqrt{2}\mu_{p}}{\sigma_{p}} }}{(\sqrt{2}+\sigma_{p})(\sqrt{2\pi})}+\frac{e^{\frac{\sqrt2}{\sigma_{q}}}}{2\sqrt{2\pi}\sigma^{2}_{q}(\sigma_{q}-\sqrt{2})} \\
\end{aligned} $$

\subsubsection{Lognormal-Gamma}

$$ \begin{aligned} \text { CrossEntropy }&=-\int_{0}^{+\infty} p_{\mu,\sigma}(x) \log q_{k,\theta}(x) \mathrm{d} x \\
&=-\int_{0}^{+\infty } \frac{e^{-\frac{(\log{x}-\mu)^{2}}{2\theta^{2}} }}{x\sigma\sqrt{2\pi}} \log\frac{x^{k-1}}{\Gamma(k)\theta^{k}}dx+\frac{\int_{0}^{+\infty} x^{\frac{2-\sqrt{2\sigma}}{\sqrt2\sigma}e^{x} }dx }{(\sigma-\sqrt{2\pi})e^{\theta+\frac{2\mu}{\sqrt{2\sigma}}}} \\
\end{aligned} $$

\section{Bounded}

\subsection{Beta Reference}

\noindent \textbf{Entropy:}
$$ \begin{aligned} \text{Entropy}&=-\mathbb{E}_{Q}\left[\logf(\alpha_{p},\beta_{p})\right]\\&=\int_{0}^{1}-f(\alpha_{p},\beta_{p})log(f(\alpha_{p},\beta_{p}))dx\\&=log(B(\alpha_{p},\beta_{p}))-(\alpha_{p}-1)\psi(\alpha_{p})-(\beta_{p}-1)\psi(\beta_{p})+(\alpha_{p}+\beta_{p}-2)\psi(\alpha_{p}+\beta_{p})
\end{aligned} $$

\subsubsection{Beta Target}

\noindent \textbf{Existing Work:}

\noindent \textbf{Cross-Entropy:}
$$ \begin{aligned} \text {CrossEntropy }&=\int_{0}^{1}-f(\alpha_{p},\beta_{p})log(f(\alpha_{q},\beta_{q}))dx\\ &=log(B(\alpha_{q},\beta_{q}))-(\alpha_{q}-1)\psi(\alpha_{p})-(\beta_{q}-1)\psi(\beta)+(\alpha_{q}+\beta_{q}-2)\psi(\alpha_{p}+\beta_{p})\\
\end{aligned} $$
\noindent \textbf{KL:}
$$ \begin{aligned}
\mathrm{KL}\left(\alpha_{p}, \beta_{p} ; \alpha_{q}, \beta_{q}\right)&=
log(\frac{B(\alpha_{q},\alpha_{q})}{B(\alpha_{p},\alpha_{p})})+(\alpha_{p}-\alpha_{q})\psi(\alpha_{p})+(\beta_{p}-\beta_{q})\psi(\beta_{p})+(\alpha_{q}-\alpha_{p}+\beta_{q}-\beta_{p})\psi(\alpha_{p}+\beta_{p})
\end{aligned} $$

https://en.wikipedia.org/wiki/Beta\_distribution

\subsubsection{Beta-Logitnormal}

$$ \begin{aligned} \text {CrossEntropy }\left(\alpha, \beta ; \mu, \sigma \right)&=
\log\sigma\sqrt{2\pi}+\int_{0}^{1} \frac{x^{\alpha-1}(1-x)^{\beta-1}}{B(\alpha ,\beta)} (\frac{(logitx-\mu)^2}{2\sigma^{2}}+\log{x(1-x)} )dx
\end{aligned} $$


\subsubsection{Beta-Uniform}
$$ \begin{aligned} \text {CrossEntropy }\left(\alpha, \beta ; a, b\right)&=
\int_{(0,1)\cap(a,b) } \frac{x^{\alpha-1}(1-x)^{\beta-1}}{B(\alpha-\beta)}\log(b-a) dx
\end{aligned} $$

\subsection{Logitnormal Reference}

\noindent \textbf{Entropy:}
$$ \begin{aligned} \text { Entropy }&
\end{aligned} $$



\subsubsection{Logitnormal Target}

\noindent \textbf{Existing Work:}

\noindent \textbf{Cross-Entropy:}
$$ \begin{aligned} \text { CrossEntropy }&=
\end{aligned} $$
\noindent \textbf{KL:}


\subsubsection{Logitnormal-Beta}
$$ \begin{aligned} \text {CrossEntropy }\left(\sigma,\mu ;\alpha, \beta \right)&=
-\int_{0}^{1}\frac{1}{\sigma \sqrt{2 \pi}} e^{-\frac{(\operatorname{logit}(x)-\mu)^{2}}{2 \sigma^{2}}} \frac{1}{x(1-x)} \log\frac{x^{\alpha-1}(1-x)^{\beta-1}}{B(\alpha,\beta)}dx
\end{aligned} $$

\subsubsection{Logitnormal-Uniform}
$$ \begin{aligned} \text {CrossEntropy }\left(\sigma, \mu;a,b \right)&=
\int_{(0,1)\cap(a,b) }\frac{1}{\sigma \sqrt{2 \pi}} e^{-\frac{(\operatorname{logit}(x)-\mu)^{2}}{2 \sigma^{2}}} \frac{1}{x(1-x)}\log{(b-a)}dx
\end{aligned} $$


\subsection{Uniform Reference}

\noindent \textbf{Entropy:}
$$ \begin{aligned} \text { Entropy }&=-\int_{a}^{b}\frac{1}{b-a}log(\frac{1}{b-a})dx\\&=log(b-a)
\end{aligned} $$

\subsubsection{Uniform Target}

\noindent \textbf{Existing Work:}

\noindent \textbf{Cross-Entropy:}
$$ \begin{aligned} \text { CrossEntropy }&=-\int_{(a_{p},b_{p}) \cap (a_{q},b_{q}) }\frac{1}{b_{p}-a_{p}}log(\frac{1}{b_{q}-a_{q}})dx \\&=\frac{log(b_{q}-a_{q})(\min \{b_{p},b_{q}\}-\min \{a_{p},a_{q}\})}{b_{p}-a_{p}}
\end{aligned} $$
\noindent \textbf{KL:}

$$ \begin{aligned}
\mathrm{KL}\left(a_{p}, b_{p} ; a_{q},b_{q}\right)\\&=-\text { Entropy }+\text { CrossEntropy }\\&=-log(b-a)+\frac{log(b_{q}-a_{q})(\min \{b_{p},b_{q}\}-\min \{a_{p},a_{q}\})}{b_{p}-a_{p}}\\&=\frac{log(b_{q}-a_{q})(\min \{b_{p},b_{q}\}-\min \{a_{p},a_{q}\}+a_{p}-b_{p})}{b_{q}-a_{q}}
\end{aligned} $$

\subsubsection{Uniform-Beta}
$$ \begin{aligned} \text {CrossEntropy }\left( a, b;\alpha, \beta \right)&=\frac{1}{b-a}
\int_{(0,1)\cap(a,b) }\log{\frac{x^{\alpha-1}(1-x)^{\beta-1}}{B(\alpha-\beta)}} dx
\end{aligned} $$


\subsubsection{Uniform-Logitnormal}
$$ \begin{aligned} \text {CrossEntropy }\left(a,b;\sigma, \mu \right)&=
\int_{(0,1)\cap(a,b) }\frac{1}{b-a}\log{\frac{1}{\sigma \sqrt{2 \pi}} e^{-\frac{(\operatorname{logit}(x)-\mu)^{2}}{2 \sigma^{2}}} \frac{1}{x(1-x)}}dx
\end{aligned} $$


\end{document}